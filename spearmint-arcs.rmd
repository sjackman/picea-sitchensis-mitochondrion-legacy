---
title: Optimize ARCS using Spearmint for Picea sitchensis mitochondrion
author: Shaun Jackman
output:
  html_document:
    keep_md: true
---

```{r load-libraries, message=FALSE}
library(dplyr)
library(GGally)
library(ggplot2)
library(knitr)
library(readr)
library(tidyr)
```

```{r setup}
knit_print.data.frame <- function(x, ...) kable(x) %>% paste(collapse = "\n") %>% asis_output
```

# Read data
```{r read-data}
spearmint_arcs <- read_tsv("spearmint-arcs.tsv", col_types = cols(
  c = col_integer(),
  e = col_integer(),
  r = col_double(),
  a = col_double(),
  l = col_integer(),
  NG50 = col_integer(),
  Index = col_integer()))
```

# Report the assembly with the maximum NG50
```{r max-NG50}
spearmint_arcs %>% filter(NG50 == max(NG50))
```

# Plot NG50 vs each parameter
```{r NG50}
ggplot(spearmint_arcs %>%
		gather("Variable", "Value", -NG50)) +
	aes(x = Value, y = NG50) +
	facet_wrap(~Variable, scales = "free") +
	geom_point()
```

# Plot NG50 vs `r`
```{r NG50-vs-r}
ggplot(spearmint_arcs) +
	aes(x = r, y = NG50, colour = a == 1 & c == 1 & l == 1) +
	geom_point() +
  coord_cartesian(c(0.8, 1.0))
```

# Tidy data
```{r tidy-data}
spearmint_arcs_tall <- spearmint_arcs %>%
	gather("Variable", "Value", -Index)
```

# Pairs plot
```{r pairsplot}
ggpairs(spearmint_arcs %>% select(-Index))
```

# Boxplot
```{r boxplot}
ggplot(spearmint_arcs_tall) +
	aes(x = 0, y = Value) +
	facet_wrap(~Variable, scales = "free") +
	geom_boxplot()
```

# Table of parameters and metric
```{r parameters-metric-table}
spearmint_arcs
```
